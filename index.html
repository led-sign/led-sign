<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO 및 메타 태그 (마일스톤 5 적용) -->
    <title>온라인 LED 전광판 만들기 | Web Scroller</title>
    <meta name="description" content="텍스트, 색상, 속도를 마음대로 조절하는 나만의 온라인 LED 전광판을 만들어보세요. 전체 화면 기능으로 실제 전광판처럼 즐길 수 있습니다.">
    <meta name="keywords" content="LED 전광판, 온라인 전광판, 웹 전광판, 텍스트 스크롤러, digital signboard, led scroller">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DHM2Q6G3P"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-9DHM2Q6G3P');
    </script>
    
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        :root {
            --scroll-duration: 10s;
            --blink-duration: 1s;
        }
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        .scrolling-text {
            /* 기본 스크롤 애니메이션 */
            animation: marquee var(--scroll-duration) linear infinite;
        }
        
        /* 정지 모드 클래스: 애니메이션을 멈추고 위치를 초기화하지 않음 (JS로 제어) */
        .scrolling-text.static-mode {
            animation-name: none !important; /* 스크롤 애니메이션 제거 */
            transform: none !important;      /* 위치 변환 제거 */
            width: auto;
        }

        .scrolling-text.blinking-text {
            /* 스크롤과 깜빡임 동시 적용 (정지 모드가 아닐 때) */
            animation: 
                marquee var(--scroll-duration) linear infinite,
                blink var(--blink-duration) ease-in-out infinite;
        }

        /* 정지 모드이면서 깜빡임이 켜져 있을 때 */
        .scrolling-text.static-mode.blinking-text {
            animation: blink var(--blink-duration) ease-in-out infinite;
        }

        /* 미리보기 컨테이너 설정 */
        #preview-wrapper {
            display: flex;
            align-items: center; /* 세로 중앙 정렬 */
            overflow: hidden;    /* 넘치는 내용 숨김 */
        }
        
        #preview {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center; /* 세로 중앙 정렬 */
            /* 스크롤 모드일 땐 justify-content가 start여야 자연스러움 */
            justify-content: flex-start; 
        }

        /* 정지 모드일 때는 가로 중앙 정렬 */
        #preview.static-layout {
            justify-content: center;
        }

        #preview-wrapper:fullscreen #preview {
            height: 100%;
        }

        /* 언어 모달 */
        #language-modal {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center p-4">

    <!-- 언어 변경 모달 -->
    <div id="language-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden opacity-0">
        <div class="bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
            <p id="language-modal-text" class="mb-4">Switch to English?</p>
            <div class="flex justify-center space-x-4">
                <button id="lang-confirm-yes" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition">Yes</button>
                <button id="lang-confirm-no" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded-lg transition">No</button>
            </div>
        </div>
    </div>

    <div class="w-full max-w-4xl mx-auto">
        <!-- === 미리보기 영역 === -->
        <div id="preview-wrapper" class="bg-black border-4 border-gray-700 rounded-lg overflow-hidden mb-8 shadow-lg h-64 relative">
            <div id="preview">
                <!-- whitespace-nowrap: 줄바꿈 방지 -->
                <p id="scrolling-text-element" class="text-6xl font-bold scrolling-text whitespace-nowrap" style="color: rgb(255, 221, 0);">여기에 텍스트를 입력하세요</p>
            </div>
        </div>

        <!-- === 컨트롤 패널 === -->
        <div id="control-panel" class="bg-gray-800 p-6 rounded-lg shadow-2xl">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                <div class="lg:col-span-3">
                    <label for="text-input" class="block text-sm font-medium text-gray-300 mb-2" data-translate-key="textLabel">표시할 텍스트</label>
                    <input type="text" id="text-input" value="여기에 텍스트를 입력하세요" class="w-full bg-gray-700 border-gray-600 rounded-md px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2" data-translate-key="textColorLabel">글자 색상</label>
                    <div class="flex items-center space-x-2" id="preset-colors">
                        <button data-color="rgb(239, 68, 68)" class="w-8 h-8 rounded-full bg-red-500 border-2 border-transparent hover:border-white transition"></button>
                        <button data-color="rgb(250, 204, 21)" class="w-8 h-8 rounded-full bg-yellow-400 border-2 border-transparent hover:border-white transition"></button>
                        <button data-color="rgb(34, 197, 94)" class="w-8 h-8 rounded-full bg-green-500 border-2 border-transparent hover:border-white transition"></button>
                        <button data-color="rgb(59, 130, 246)" class="w-8 h-8 rounded-full bg-blue-500 border-2 border-transparent hover:border-white transition"></button>
                        <input type="color" id="text-color-picker" value="#ffdd00" class="w-8 h-8 bg-gray-700 rounded-full cursor-pointer border-2 border-gray-600">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2" data-translate-key="bgColorLabel">배경 색상</label>
                    <div class="flex items-center space-x-2">
                        <button data-bg-color="#000000" class="w-8 h-8 rounded-full bg-black border-2 border-gray-500 hover:border-white transition"></button>
                        <button data-bg-color="#FFFFFF" class="w-8 h-8 rounded-full bg-white border-2 border-gray-500 hover:border-black transition"></button>
                        <input type="color" id="bg-color-picker" value="#000000" class="w-8 h-8 bg-gray-700 rounded-full cursor-pointer border-2 border-gray-600">
                    </div>
                </div>

                <!-- 글자 크기 + 자동 맞춤 -->
                <div class="lg:col-span-1">
                    <div class="flex justify-between items-center mb-2">
                        <label for="font-size-slider" class="block text-sm font-medium text-gray-300">
                            <span data-translate-key="fontSizeLabel">글자 크기:</span> <span id="font-size-value">60</span>px
                        </label>
                        <!-- 화면 꽉 채우기 체크박스 -->
                        <div class="flex items-center">
                            <input type="checkbox" id="auto-fit-check" class="w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                            <label for="auto-fit-check" class="ml-2 text-xs text-gray-300 cursor-pointer select-none" data-translate-key="autoFitLabel">화면 꽉 채우기</label>
                        </div>
                    </div>
                    <input type="range" id="font-size-slider" min="10" max="300" value="60" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <!-- 스크롤 속도 + 정지 모드 -->
                <div class="lg:col-span-1">
                    <div class="flex justify-between items-center mb-2">
                        <label for="scroll-speed-slider" class="block text-sm font-medium text-gray-300">
                            <span data-translate-key="scrollSpeedLabel">스크롤 속도:</span> <span id="scroll-speed-value">10</span>s
                        </label>
                        <!-- 텍스트 고정 체크박스 -->
                        <div class="flex items-center">
                            <input type="checkbox" id="static-mode-check" class="w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                            <label for="static-mode-check" class="ml-2 text-xs text-gray-300 cursor-pointer select-none" data-translate-key="staticModeLabel">텍스트 고정</label>
                        </div>
                    </div>
                    <input type="range" id="scroll-speed-slider" min="1" max="30" value="10" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="lg:col-span-1">
                    <label for="blink-speed-slider" class="block text-sm font-medium text-gray-300 mb-2">
                        <span data-translate-key="blinkSpeedLabel">깜빡임 속도:</span> <span id="blink-speed-value">0.0</span><span data-translate-key="blinkSuffix">s (0=없음)</span>
                    </label>
                    <input type="range" id="blink-speed-slider" min="0" max="5" step="0.1" value="0" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                </div>
            </div>

            <div class="mt-8 flex flex-col md:flex-row items-center justify-center md:justify-between">
                <div class="flex items-center space-x-2 mb-4 md:mb-0">
                    <span class="text-sm font-medium">KO</span>
                    <label for="language-toggle" class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" value="" id="language-toggle" class="sr-only peer">
                        <div class="w-11 h-6 bg-gray-600 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                    </label>
                    <span class="text-sm font-medium">EN</span>
                </div>
                
                <button id="play-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition-transform transform hover:scale-105 shadow-lg flex items-center space-x-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span data-translate-key="playButton">전체 화면으로 재생</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const textInput = document.getElementById('text-input');
            const textColorPicker = document.getElementById('text-color-picker');
            const bgColorPicker = document.getElementById('bg-color-picker');
            const fontSizeSlider = document.getElementById('font-size-slider');
            const scrollSpeedSlider = document.getElementById('scroll-speed-slider');
            const blinkSpeedSlider = document.getElementById('blink-speed-slider');
            const staticModeCheck = document.getElementById('static-mode-check');
            const autoFitCheck = document.getElementById('auto-fit-check');

            const fontSizeValue = document.getElementById('font-size-value');
            const scrollSpeedValue = document.getElementById('scroll-speed-value');
            const blinkSpeedValue = document.getElementById('blink-speed-value');
            const scrollingTextElement = document.getElementById('scrolling-text-element');
            const previewWrapper = document.getElementById('preview-wrapper');
            const previewDiv = document.getElementById('preview');
            
            const presetColorButtons = document.querySelectorAll('#preset-colors button');
            const presetBgColorButtons = document.querySelectorAll('[data-bg-color]');
            const playButton = document.getElementById('play-button');
            const languageToggle = document.getElementById('language-toggle');
            const languageModal = document.getElementById('language-modal');
            const langConfirmYes = document.getElementById('lang-confirm-yes');
            const langConfirmNo = document.getElementById('lang-confirm-no');
            const root = document.documentElement;

            // --- 번역 데이터 ---
            const translations = {
                ko: {
                    textLabel: '표시할 텍스트',
                    textColorLabel: '글자 색상',
                    bgColorLabel: '배경 색상',
                    fontSizeLabel: '글자 크기:',
                    scrollSpeedLabel: '스크롤 속도:',
                    blinkSpeedLabel: '깜빡임 속도:',
                    playButton: '전체 화면으로 재생',
                    blinkSuffix: 's (0=없음)',
                    placeholder: '여기에 텍스트를 입력하세요',
                    staticModeLabel: '텍스트 고정',
                    autoFitLabel: '화면 꽉 채우기'
                },
                en: {
                    textLabel: 'Display Text',
                    textColorLabel: 'Text Color',
                    bgColorLabel: 'Background Color',
                    fontSizeLabel: 'Font Size:',
                    scrollSpeedLabel: 'Scroll Speed:',
                    blinkSpeedLabel: 'Blink Speed:',
                    playButton: 'Play Fullscreen',
                    blinkSuffix: 's (0=off)',
                    placeholder: 'Enter your text here',
                    staticModeLabel: 'Static Text',
                    autoFitLabel: 'Fit to Screen'
                }
            };

            // --- 자동 크기 조절 함수 (핵심 로직) ---
            function adjustFontSizeToFit() {
                if (!autoFitCheck.checked) return; // 체크 안 되어있으면 실행 안 함

                const containerWidth = previewWrapper.clientWidth;
                const containerHeight = previewWrapper.clientHeight;
                const text = scrollingTextElement.innerText;
                const isStatic = staticModeCheck.checked;

                // 측정을 위해 임시로 폰트 크기 설정
                let minSize = 10;
                let maxSize = 1000; // 충분히 큰 값
                let optimalSize = 10;

                // 이진 탐색으로 최적의 크기 찾기 (성능 최적화)
                // 단순히 1씩 증가시키는 것보다 빠름
                let low = minSize;
                let high = maxSize;

                // 텍스트 측정을 위한 임시 요소 생성 (화면에 그리진 않음)
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                context.font = `bold 100px 'Inter', sans-serif`; // 폰트 패밀리 맞춤

                while (low <= high) {
                    let mid = Math.floor((low + high) / 2);
                    context.font = `bold ${mid}px 'Inter', sans-serif`;
                    const metrics = context.measureText(text);
                    const textWidth = metrics.width;
                    const textHeight = mid; // 대략적인 높이

                    let fits = false;
                    if (isStatic) {
                        // 정지 모드: 가로와 세로 모두 화면 안에 들어와야 함 (여유 공간 5%)
                        fits = (textWidth <= containerWidth * 0.95) && (textHeight <= containerHeight * 0.95);
                    } else {
                        // 스크롤 모드: 세로만 화면 안에 들어오면 됨 (가로는 넘쳐도 됨)
                        fits = (textHeight <= containerHeight * 0.95);
                    }

                    if (fits) {
                        optimalSize = mid;
                        low = mid + 1;
                    } else {
                        high = mid - 1;
                    }
                }

                // 계산된 크기 적용
                scrollingTextElement.style.fontSize = `${optimalSize}px`;
                fontSizeSlider.value = Math.min(optimalSize, 300); // 슬라이더 UI 업데이트 (최대값 제한)
                fontSizeValue.innerText = optimalSize;
            }

            // --- 이벤트 리스너 ---

            // 텍스트 입력 시
            textInput.addEventListener('input', e => {
                scrollingTextElement.innerText = e.target.value;
                if (autoFitCheck.checked) adjustFontSizeToFit();
            });

            // 색상 변경
            textColorPicker.addEventListener('input', e => scrollingTextElement.style.color = e.target.value);
            bgColorPicker.addEventListener('input', e => previewWrapper.style.backgroundColor = e.target.value);
            presetColorButtons.forEach(btn => btn.addEventListener('click', () => {
                scrollingTextElement.style.color = btn.dataset.color;
                textColorPicker.value = rgbToHex(btn.dataset.color);
            }));
            presetBgColorButtons.forEach(btn => btn.addEventListener('click', () => {
                previewWrapper.style.backgroundColor = btn.dataset.bgColor;
                bgColorPicker.value = btn.dataset.bgColor;
            }));

            // 글자 크기 슬라이더 (자동 맞춤이 꺼져있을 때만 작동)
            fontSizeSlider.addEventListener('input', e => {
                if (autoFitCheck.checked) return; // 자동 맞춤 중에는 슬라이더 무시
                const size = e.target.value;
                scrollingTextElement.style.fontSize = `${size}px`;
                fontSizeValue.innerText = size;
            });

            // 화면 꽉 채우기 (Auto Fit) 토글
            autoFitCheck.addEventListener('change', e => {
                if (e.target.checked) {
                    fontSizeSlider.disabled = true; // 슬라이더 비활성화
                    fontSizeSlider.classList.add('opacity-50', 'cursor-not-allowed');
                    adjustFontSizeToFit();
                } else {
                    fontSizeSlider.disabled = false; // 슬라이더 활성화
                    fontSizeSlider.classList.remove('opacity-50', 'cursor-not-allowed');
                    // 원래 슬라이더 값으로 복귀
                    scrollingTextElement.style.fontSize = `${fontSizeSlider.value}px`;
                }
            });

            // 텍스트 고정 (Static Mode) 토글
            staticModeCheck.addEventListener('change', e => {
                if (e.target.checked) {
                    scrollingTextElement.classList.add('static-mode');
                    previewDiv.classList.add('static-layout');
                    scrollSpeedSlider.disabled = true;
                    scrollSpeedSlider.classList.add('opacity-50', 'cursor-not-allowed');
                } else {
                    scrollingTextElement.classList.remove('static-mode');
                    previewDiv.classList.remove('static-layout');
                    scrollSpeedSlider.disabled = false;
                    scrollSpeedSlider.classList.remove('opacity-50', 'cursor-not-allowed');
                }
                // 모드 변경 시 크기 재계산 (맞춤 옵션이 켜져있을 경우 기준이 달라지므로)
                if (autoFitCheck.checked) adjustFontSizeToFit();
            });

            // 스크롤 속도
            scrollSpeedSlider.addEventListener('input', e => {
                root.style.setProperty('--scroll-duration', `${e.target.value}s`);
                scrollSpeedValue.innerText = e.target.value;
            });

            // 깜빡임 속도
            blinkSpeedSlider.addEventListener('input', e => {
                const speed = e.target.value;
                if (speed > 0) {
                    scrollingTextElement.classList.add('blinking-text');
                    root.style.setProperty('--blink-duration', `${speed}s`);
                } else {
                    scrollingTextElement.classList.remove('blinking-text');
                }
                blinkSpeedValue.innerText = parseFloat(speed).toFixed(1);
            });

            // 전체 화면
            playButton.addEventListener('click', () => {
                if (previewWrapper.requestFullscreen) previewWrapper.requestFullscreen();
                else if (previewWrapper.webkitRequestFullscreen) previewWrapper.webkitRequestFullscreen();
                else if (previewWrapper.msRequestFullscreen) previewWrapper.msRequestFullscreen();
            });

            // 전체 화면 변경 감지 (크기가 변하므로 자동 맞춤 재실행)
            document.addEventListener('fullscreenchange', () => {
                // 전체 화면 전환 애니메이션이 끝난 후 약간의 딜레이를 두고 계산
                setTimeout(() => {
                    if (autoFitCheck.checked) adjustFontSizeToFit();
                }, 100);
            });
            window.addEventListener('resize', () => {
                if (autoFitCheck.checked) adjustFontSizeToFit();
            });

            // --- 언어 및 기타 ---
            function translateUI(lang) {
                document.querySelectorAll('[data-translate-key]').forEach(el => {
                    const key = el.dataset.translateKey;
                    if (translations[lang][key]) el.innerText = translations[lang][key];
                });
                const defaultKo = translations.ko.placeholder;
                const defaultEn = translations.en.placeholder;
                if (textInput.value === defaultKo || textInput.value === defaultEn) {
                    textInput.value = translations[lang].placeholder;
                    scrollingTextElement.innerText = translations[lang].placeholder;
                }
            }

            languageToggle.addEventListener('change', e => translateUI(e.target.checked ? 'en' : 'ko'));
            
            // 초기 언어 설정
            const userLang = navigator.language || navigator.userLanguage;
            if (!userLang.startsWith('ko')) {
                document.getElementById('language-modal-text').innerText = 'Switch to English?';
                languageModal.classList.remove('hidden');
                setTimeout(() => languageModal.classList.remove('opacity-0'), 10);
            }
            langConfirmYes.addEventListener('click', () => {
                translateUI('en');
                languageToggle.checked = true;
                closeModal();
            });
            function closeModal() {
                languageModal.classList.add('opacity-0');
                setTimeout(() => languageModal.classList.add('hidden'), 300);
            }
            langConfirmNo.addEventListener('click', closeModal);

            function rgbToHex(rgb) {
                if (!rgb) return "#000000";
                let sep = rgb.includes(",") ? "," : " ";
                rgb = rgb.substr(4).split(")")[0].split(sep);
                let r = (+rgb[0]).toString(16).padStart(2, '0');
                let g = (+rgb[1]).toString(16).padStart(2, '0');
                let b = (+rgb[2]).toString(16).padStart(2, '0');
                return "#" + r + g + b;
            }
        });
    </script>
</body>
</html>